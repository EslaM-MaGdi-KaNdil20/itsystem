import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { apiPost, apiGet } from '../utils/api';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ¢ COMPANY CONFIG â€” ØºÙŠÙ‘Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ù‡Ù†Ø§
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const COMPANY = {
  name: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ø±ÙƒØ©',
  nameEn: 'COMPANY GROUP',
  slogan: 'Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ø°ÙƒÙŠØ©',
  description: 'ÙØ±ÙŠÙ‚Ù†Ø§ Ø§Ù„Ù…ØªØ®ØµØµ Ø¬Ø§Ù‡Ø² Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©. Ù‚Ø¯Ù‘Ù… Ø·Ù„Ø¨Ùƒ ÙˆØ³Ù†ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ Ø¨Ø£Ù‚ØµÙ‰ Ø³Ø±Ø¹Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©.',
  // â† Ø¶Ø¹ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ù‡Ù†Ø§ (ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† ØµÙˆØ±Ø© Ù„Ù„Ù…Ø¨Ù†Ù‰ Ø£Ùˆ Ø§Ù„Ù„ÙˆØ¬Ùˆ)
  // heroBg: '/hero-bg.jpg',
  heroBg: null,
  // â† Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù„ÙˆØ¬Ùˆ Ù‡Ù†Ø§
  // logo: '/logo.png',
  logo: null,
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONSTANTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CATEGORIES = [
  { value: 'hardware', label: 'Ø£Ø¬Ù‡Ø²Ø© ÙˆÙ…Ø¹Ø¯Ø§Øª', desc: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ±ØŒ Ø·Ø§Ø¨Ø¹Ø©ØŒ Ø´Ø§Ø´Ø©ØŒ Ù…Ø§ÙˆØ³', emoji: 'ğŸ–¥ï¸', color: '#6366f1' },
  { value: 'software', label: 'Ø¨Ø±Ø§Ù…Ø¬ ÙˆØªØ·Ø¨ÙŠÙ‚Ø§Øª', desc: 'ØªØ«Ø¨ÙŠØªØŒ ØªØ­Ø¯ÙŠØ«ØŒ ØªØ±Ø®ÙŠØµØŒ Ø£Ø¹Ø·Ø§Ù„', emoji: 'âš™ï¸', color: '#8b5cf6' },
  { value: 'network', label: 'Ø´Ø¨ÙƒØ© ÙˆØ¥Ù†ØªØ±Ù†Øª', desc: 'Ø§ØªØµØ§Ù„ØŒ WiFiØŒ VPNØŒ Ø¨Ø·Ø¡', emoji: 'ğŸŒ', color: '#06b6d4' },
  { value: 'email', label: 'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', desc: 'OutlookØŒ Ø­Ø³Ø§Ø¨ØŒ Ø¥Ø±Ø³Ø§Ù„ØŒ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„', emoji: 'ğŸ“§', color: '#0ea5e9' },
  { value: 'access', label: 'ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ¯Ø®ÙˆÙ„', desc: 'ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±ØŒ Ø£Ø°ÙˆÙ†Ø§ØªØŒ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯', emoji: 'ğŸ”', color: '#f59e0b' },
  { value: 'general', label: 'Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù…', desc: 'Ø·Ù„Ø¨Ø§Øª Ø£Ø®Ø±Ù‰ ÙˆÙ…ØªÙ†ÙˆØ¹Ø©', emoji: 'ğŸ’¬', color: '#10b981' },
];

const PRIORITIES = [
  { value: 'low', label: 'Ù…Ù†Ø®ÙØ¶Ø©', color: '#64748b', icon: 'ğŸŸ¢' },
  { value: 'medium', label: 'Ù…ØªÙˆØ³Ø·Ø©', color: '#3b82f6', icon: 'ğŸ”µ' },
  { value: 'high', label: 'Ø¹Ø§Ù„ÙŠØ©', color: '#f97316', icon: 'ğŸŸ ' },
  { value: 'urgent', label: 'Ø¹Ø§Ø¬Ù„Ø©', color: '#ef4444', icon: 'ğŸ”´' },
];

const RESPONSE_TIMES = {
  low:    { time: 'Ø³ÙˆÙ ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø®Ù„Ø§Ù„ Ù¥ Ø¯Ù‚Ø§Ø¦Ù‚', icon: 'ğŸ•', label: 'Ù…Ù†Ø®ÙØ¶Ø©', color: '#64748b' },
  medium: { time: 'Ø³ÙˆÙ ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø®Ù„Ø§Ù„ Ù¥ Ø¯Ù‚Ø§Ø¦Ù‚', icon: 'â±ï¸', label: 'Ù…ØªÙˆØ³Ø·Ø©', color: '#3b82f6' },
  high:   { time: 'Ø³ÙˆÙ ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø®Ù„Ø§Ù„ Ù¥ Ø¯Ù‚Ø§Ø¦Ù‚', icon: 'âš¡', label: 'Ø¹Ø§Ù„ÙŠØ©',  color: '#f97316' },
  urgent: { time: 'Ø³ÙˆÙ ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø®Ù„Ø§Ù„ Ù¥ Ø¯Ù‚Ø§Ø¦Ù‚', icon: 'ğŸš¨', label: 'Ø¹Ø§Ø¬Ù„Ø©',  color: '#ef4444' },
};

const FEATURES = [
  { icon: 'âš¡', title: 'Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙÙˆØ±ÙŠØ©', desc: 'ÙØ±ÙŠÙ‚Ù†Ø§ ÙŠØ³ØªØ¬ÙŠØ¨ ÙÙŠ Ø¯Ù‚Ø§Ø¦Ù‚' },
  { icon: 'ğŸ”’', title: 'Ø³Ø±Ù‘ÙŠØ© ØªØ§Ù…Ø©', desc: 'Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠÙ‘Ø© ÙˆÙ…Ø´ÙÙ‘Ø±Ø©' },
  { icon: 'ğŸ“Š', title: 'ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø±', desc: 'ØªØ§Ø¨Ø¹ Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ù„Ø­Ø¸ÙŠØ§Ù‹' },
  { icon: 'ğŸ†', title: 'Ø®Ø¨Ø±Ø§Ø¡ Ù…ØªØ®ØµØµÙˆÙ†', desc: 'ÙØ±ÙŠÙ‚ Ù…Ø¹ØªÙ…Ø¯ ÙˆÙ…Ø¯Ø±Ù‘Ø¨' },
];

const STEPS_INFO = [
  { num: '1', title: 'Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ', desc: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©' },
  { num: '2', title: 'Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©', desc: 'Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨' },
  { num: '3', title: 'ÙˆØµÙ Ø§Ù„Ø·Ù„Ø¨', desc: 'Ø§Ø´Ø±Ø­ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¨Ø¯Ù‚Ø©' },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN COMPONENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
export default function UserTicketPortal() {
  const [form, setForm] = useState({
    requester_name: '', requester_email: '', requester_phone: '', requester_department: '',
    title: '', description: '', category: '', priority: 'medium',
  });
  const [step, setStep] = useState(0); // 0=form, tracked via sections
  const [loading, setLoading] = useState(false);
  const [done, setDone] = useState(null);
  const [error, setError] = useState('');
  const [trackInput, setTrackInput] = useState('');
  const [trackResult, setTrackResult] = useState(null);
  const [trackError, setTrackError] = useState('');
  const [trackLoading, setTrackLoading] = useState(false);
  const [showTracker, setShowTracker] = useState(false);
  const [scrolled, setScrolled] = useState(false);

  useEffect(() => {
    const onScroll = () => setScrolled(window.scrollY > 50);
    window.addEventListener('scroll', onScroll);
    return () => window.removeEventListener('scroll', onScroll);
  }, []);

  const set = (k, v) => setForm(p => ({ ...p, [k]: v }));

  const submit = async (e) => {
    e.preventDefault();
    if (!form.category) { setError('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©.'); return; }
    if (!form.requester_name || !form.requester_email || !form.requester_department) { setError('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.'); return; }
    if (!form.title) { setError('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ù…Ø´ÙƒÙ„Ø©.'); return; }
    setError('');
    setLoading(true);
    try {
      const res = await apiPost('/tickets', form);
      setDone(res.ticket_number || res.data?.ticket_number);
    } catch (err) {
      setError(err?.response?.data?.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¬Ø¯Ø¯Ø§Ù‹.');
    } finally { setLoading(false); }
  };

  const resetForm = () => {
    setDone(null);
    setTrackInput('');
    setTrackResult(null);
    setTrackError('');
    setShowTracker(false);
    setForm({ requester_name: '', requester_email: '', requester_phone: '', requester_department: '', title: '', description: '', category: '', priority: 'medium' });
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleTrack = async () => {
    const num = trackInput.trim().toUpperCase();
    if (!num) return;
    setTrackLoading(true);
    setTrackResult(null);
    setTrackError('');
    try {
      const data = await apiGet(`/tickets/track/${num}`);
      setTrackResult(data);
    } catch (err) {
      setTrackError(err?.message || err?.response?.data?.error || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…');
    } finally { setTrackLoading(false); }
  };

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SUCCESS STATE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  if (done) {
    const rt = RESPONSE_TIMES[form.priority] || RESPONSE_TIMES.medium;
    const firstName = form.requester_name.trim().split(' ')[0] || 'Ù…ÙˆØ¸ÙÙ†Ø§ Ø§Ù„Ø¹Ø²ÙŠØ²';

    return (
      <div className="ticket-portal" dir="rtl">
        {/* Fixed Navbar */}
        <Navbar scrolled={true} onTrack={() => setShowTracker(true)} />

        <div style={{ minHeight: '100vh', background: '#f8fafc', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '100px 1rem 2rem' }}>
          <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.6 }}
            style={{ width: '100%', maxWidth: 560 }}>
            
            {/* Success Card */}
            <div style={{ background: '#fff', borderRadius: 24, boxShadow: '0 25px 60px rgba(0,0,0,0.08)', border: '1px solid #e2e8f0', overflow: 'hidden' }}>
              {/* Top gradient */}
              <div style={{ height: 4, background: 'linear-gradient(90deg, #22c55e, #16a34a, #86efac)' }} />
              
              <div style={{ padding: '48px 40px' }}>
                {/* Success Icon */}
                <div style={{ textAlign: 'center', marginBottom: 32 }}>
                  <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ delay: 0.15, type: 'spring', stiffness: 200 }}
                    style={{ width: 80, height: 80, borderRadius: '50%', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 24px', boxShadow: '0 16px 40px rgba(34,197,94,0.25)' }}>
                    <svg width="36" height="36" fill="none" stroke="#fff" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"/></svg>
                  </motion.div>
                  <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}>
                    <p style={{ color: '#16a34a', fontSize: 13, fontWeight: 700, marginBottom: 6, letterSpacing: 1 }}>âœ“ ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­</p>
                    <h2 style={{ fontSize: 28, fontWeight: 800, color: '#0f172a', margin: '0 0 8px' }}>
                      Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ ÙŠØ§ <span style={{ color: '#6366f1' }}>{firstName}</span>
                    </h2>
                    <p style={{ color: '#64748b', fontSize: 15, lineHeight: 1.7 }}>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨Ùƒ ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙÙˆØ±Ø§Ù‹</p>
                  </motion.div>
                </div>

                {/* Ticket Number */}
                <div style={{ background: '#f8fafc', border: '2px dashed #e2e8f0', borderRadius: 16, padding: '20px', textAlign: 'center', marginBottom: 20 }}>
                  <p style={{ color: '#94a3b8', fontSize: 11, fontWeight: 700, letterSpacing: 2, marginBottom: 8 }}>Ø±Ù‚Ù… Ø§Ù„ØªØ°ÙƒØ±Ø©</p>
                  <p style={{ fontSize: 32, fontWeight: 900, color: '#6366f1', fontFamily: 'monospace', letterSpacing: 4, margin: 0 }}>{done}</p>
                </div>

                {/* Response Time */}
                <div style={{ background: `${rt.color}08`, border: `1px solid ${rt.color}20`, borderRadius: 14, padding: '16px 20px', marginBottom: 24, display: 'flex', alignItems: 'center', gap: 14 }}>
                  <span style={{ fontSize: 28 }}>{rt.icon}</span>
                  <div>
                    <p style={{ margin: 0, color: '#64748b', fontSize: 12, fontWeight: 600 }}>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ â€” Ø£ÙˆÙ„ÙˆÙŠØ© {rt.label}</p>
                    <p style={{ margin: '4px 0 0', fontSize: 17, fontWeight: 800, color: rt.color }}>{rt.time}</p>
                  </div>
                </div>

                {/* Track Section */}
                <div style={{ background: '#f8fafc', borderRadius: 14, padding: '18px 20px', marginBottom: 24, border: '1px solid #e2e8f0' }}>
                  <p style={{ color: '#475569', fontSize: 13, fontWeight: 700, marginBottom: 10 }}>ğŸ” ØªØªØ¨Ø¹ Ø·Ù„Ø¨Ùƒ</p>
                  <div style={{ display: 'flex', gap: 10 }}>
                    <input value={trackInput} onChange={e => setTrackInput(e.target.value)} placeholder={done}
                      style={{ flex: 1, background: '#fff', border: '1.5px solid #e2e8f0', borderRadius: 10, padding: '10px 14px', color: '#0f172a', fontSize: 14, fontFamily: 'monospace', outline: 'none' }}
                      onFocus={e => e.target.style.borderColor = '#6366f1'} onBlur={e => e.target.style.borderColor = '#e2e8f0'} />
                    <button onClick={handleTrack} disabled={trackLoading}
                      style={{ background: '#6366f1', color: '#fff', border: 'none', borderRadius: 10, padding: '10px 20px', fontWeight: 700, fontSize: 14, cursor: 'pointer' }}>
                      {trackLoading ? '...' : 'ØªØªØ¨Ø¹'}
                    </button>
                  </div>
                  {trackError && <div style={{ marginTop: 10, background: '#fef2f2', border: '1px solid #fecaca', borderRadius: 10, padding: '10px 14px', color: '#dc2626', fontSize: 13, fontWeight: 600 }}>âš ï¸ {trackError}</div>}
                  {trackResult && <TrackResultCard result={trackResult} />}
                </div>

                {/* Actions */}
                <div style={{ display: 'flex', gap: 12 }}>
                  <button onClick={resetForm}
                    style={{ flex: 1, background: '#6366f1', color: '#fff', border: 'none', borderRadius: 12, padding: '14px', fontWeight: 700, fontSize: 15, cursor: 'pointer', boxShadow: '0 4px 16px rgba(99,102,241,0.25)' }}>
                    + Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                  </button>
                  <button onClick={() => navigator.clipboard?.writeText(done)}
                    style={{ background: '#f1f5f9', color: '#475569', border: '1px solid #e2e8f0', borderRadius: 12, padding: '14px 20px', fontWeight: 700, fontSize: 15, cursor: 'pointer' }}>
                    ğŸ“‹ Ù†Ø³Ø®
                  </button>
                </div>
              </div>
            </div>

            <p style={{ textAlign: 'center', color: '#94a3b8', fontSize: 13, marginTop: 24 }}>
              Ø§Ø­ØªÙØ¸ Ø¨Ø±Ù‚Ù… Ø§Ù„ØªØ°ÙƒØ±Ø© <span style={{ color: '#6366f1', fontFamily: 'monospace', fontWeight: 700 }}>{done}</span> Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©
            </p>
          </motion.div>
        </div>

        <PortalStyles />
      </div>
    );
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN FORM PAGE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  return (
    <div className="ticket-portal" dir="rtl">

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FIXED NAVBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <Navbar scrolled={scrolled} onTrack={() => setShowTracker(!showTracker)} />

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HERO SECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <section style={{
        position: 'relative',
        minHeight: 560,
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        overflow: 'hidden',
        background: COMPANY.heroBg
          ? `url(${COMPANY.heroBg}) center/cover no-repeat`
          : 'linear-gradient(135deg, #0f172a 0%, #1e1b4b 40%, #312e81 70%, #1e293b 100%)',
      }}>
        {/* Overlay */}
        <div style={{ position: 'absolute', inset: 0, background: COMPANY.heroBg ? 'rgba(15,23,42,0.75)' : 'transparent', zIndex: 1 }} />

        {/* Animated Grid Pattern */}
        <div style={{ position: 'absolute', inset: 0, zIndex: 1, opacity: 0.04,
          backgroundImage: 'linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)',
          backgroundSize: '60px 60px',
        }} />

        {/* Decorative Glowing Orbs */}
        <div style={{ position: 'absolute', top: -100, right: '10%', width: 400, height: 400, borderRadius: '50%', background: 'radial-gradient(circle, rgba(99,102,241,0.15), transparent 70%)', filter: 'blur(60px)', zIndex: 1 }} />
        <div style={{ position: 'absolute', bottom: -80, left: '15%', width: 350, height: 350, borderRadius: '50%', background: 'radial-gradient(circle, rgba(6,182,212,0.12), transparent 70%)', filter: 'blur(50px)', zIndex: 1 }} />
        <div style={{ position: 'absolute', top: '30%', left: '5%', width: 200, height: 200, borderRadius: '50%', background: 'radial-gradient(circle, rgba(139,92,246,0.1), transparent 70%)', filter: 'blur(40px)', zIndex: 1 }} />

        {/* Floating Particles */}
        <div className="hero-particles" style={{ position: 'absolute', inset: 0, zIndex: 1 }}>
          {[...Array(6)].map((_, i) => (
            <div key={i} className="particle" style={{
              position: 'absolute',
              width: 4 + i * 2, height: 4 + i * 2,
              borderRadius: '50%',
              background: `rgba(${130 + i * 20}, ${140 + i * 15}, 241, ${0.15 + i * 0.05})`,
              top: `${15 + i * 14}%`,
              left: `${10 + i * 15}%`,
              animation: `float ${4 + i * 1.5}s ease-in-out infinite alternate`,
              animationDelay: `${i * 0.5}s`,
            }} />
          ))}
        </div>

        {/* Hero Content */}
        <div style={{ position: 'relative', zIndex: 2, textAlign: 'center', padding: '120px 24px 80px', maxWidth: 780, margin: '0 auto' }}>
          <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.7, ease: [0.22, 1, 0.36, 1] }}>
            
            {/* Company Logo / Badge */}
            {COMPANY.logo ? (
              <img src={COMPANY.logo} alt={COMPANY.name} style={{ height: 60, marginBottom: 28, filter: 'brightness(0) invert(1)', opacity: 0.9 }} />
            ) : (
              <div style={{ display: 'inline-flex', alignItems: 'center', gap: 10, background: 'rgba(255,255,255,0.08)', backdropFilter: 'blur(10px)', border: '1px solid rgba(255,255,255,0.12)', borderRadius: 100, padding: '10px 24px', marginBottom: 32 }}>
                <div style={{ width: 36, height: 36, borderRadius: 10, background: 'linear-gradient(135deg, #6366f1, #8b5cf6)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <svg width="20" height="20" fill="none" stroke="#fff" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>
                </div>
                <div style={{ textAlign: 'right' }}>
                  <p style={{ margin: 0, fontSize: 15, fontWeight: 800, color: '#fff', lineHeight: 1.2 }}>{COMPANY.name}</p>
                  <p style={{ margin: 0, fontSize: 10, fontWeight: 600, color: '#a5b4fc', letterSpacing: 2 }}>{COMPANY.nameEn}</p>
                </div>
              </div>
            )}

            <h1 style={{ fontSize: 'clamp(2rem, 5vw, 3.5rem)', fontWeight: 900, color: '#fff', lineHeight: 1.15, marginBottom: 20, letterSpacing: '-0.02em' }}>
              {COMPANY.slogan.split(' ').slice(0, -1).join(' ')}{' '}
              <span style={{ background: 'linear-gradient(90deg, #818cf8, #67e8f9, #a78bfa)', backgroundClip: 'text', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>
                {COMPANY.slogan.split(' ').slice(-1)}
              </span>
            </h1>

            <p style={{ color: '#94a3b8', fontSize: 17, lineHeight: 1.8, maxWidth: 550, margin: '0 auto 36px' }}>
              {COMPANY.description}
            </p>

            {/* CTA Buttons */}
            <div style={{ display: 'flex', gap: 14, justifyContent: 'center', flexWrap: 'wrap' }}>
              <motion.button whileHover={{ scale: 1.03 }} whileTap={{ scale: 0.97 }}
                onClick={() => document.getElementById('ticket-form')?.scrollIntoView({ behavior: 'smooth' })}
                style={{ background: 'linear-gradient(135deg, #6366f1, #4f46e5)', color: '#fff', border: 'none', borderRadius: 14, padding: '16px 36px', fontWeight: 800, fontSize: 16, cursor: 'pointer', boxShadow: '0 8px 32px rgba(99,102,241,0.35)', display: 'flex', alignItems: 'center', gap: 10 }}>
                <svg width="18" height="18" fill="none" stroke="currentColor" strokeWidth="2.5" viewBox="0 0 24 24" style={{ transform: 'scaleX(-1)' }}><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                Ù‚Ø¯Ù‘Ù… Ø·Ù„Ø¨ Ø¯Ø¹Ù…
              </motion.button>
              <motion.button whileHover={{ scale: 1.03 }} whileTap={{ scale: 0.97 }}
                onClick={() => setShowTracker(true)}
                style={{ background: 'rgba(255,255,255,0.08)', backdropFilter: 'blur(10px)', color: '#e2e8f0', border: '1px solid rgba(255,255,255,0.15)', borderRadius: 14, padding: '16px 32px', fontWeight: 700, fontSize: 16, cursor: 'pointer', display: 'flex', alignItems: 'center', gap: 10 }}>
                ğŸ” ØªØªØ¨Ø¹ Ø·Ù„Ø¨Ùƒ
              </motion.button>
            </div>
          </motion.div>
        </div>

        {/* Bottom Wave */}
        <div style={{ position: 'absolute', bottom: -1, left: 0, right: 0, zIndex: 3 }}>
          <svg viewBox="0 0 1440 80" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ display: 'block', width: '100%' }}>
            <path d="M0,40 C240,80 480,0 720,40 C960,80 1200,0 1440,40 L1440,80 L0,80 Z" fill="#f8fafc" />
          </svg>
        </div>
      </section>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FEATURES STRIP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <section style={{ background: '#f8fafc', padding: '0 24px 60px' }}>
        <div style={{ maxWidth: 1000, margin: '0 auto' }}>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 20, marginTop: -40 }}>
            {FEATURES.map((f, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ delay: i * 0.1 }}
                style={{ background: '#fff', borderRadius: 20, padding: '28px 24px', textAlign: 'center', boxShadow: '0 4px 24px rgba(0,0,0,0.04)', border: '1px solid #f1f5f9', transition: 'all 0.3s' }}
                className="feature-card">
                <span style={{ fontSize: 32, display: 'block', marginBottom: 14 }}>{f.icon}</span>
                <h4 style={{ margin: '0 0 6px', fontSize: 16, fontWeight: 800, color: '#0f172a' }}>{f.title}</h4>
                <p style={{ margin: 0, fontSize: 13, color: '#64748b', lineHeight: 1.6 }}>{f.desc}</p>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOW IT WORKS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <section style={{ background: '#fff', padding: '60px 24px', borderTop: '1px solid #f1f5f9' }}>
        <div style={{ maxWidth: 800, margin: '0 auto', textAlign: 'center' }}>
          <motion.div initial={{ opacity: 0, y: 15 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }}>
            <p style={{ color: '#6366f1', fontSize: 13, fontWeight: 700, letterSpacing: 2, marginBottom: 8 }}>â—  ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ</p>
            <h2 style={{ fontSize: 28, fontWeight: 900, color: '#0f172a', marginBottom: 40 }}>Ø«Ù„Ø§Ø« Ø®Ø·ÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨Ùƒ</h2>
          </motion.div>
          
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 32 }}>
            {STEPS_INFO.map((s, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ delay: i * 0.15 }}
                style={{ position: 'relative' }}>
                <div style={{ width: 56, height: 56, borderRadius: 16, background: 'linear-gradient(135deg, #eef2ff, #e0e7ff)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 16px', fontSize: 22, fontWeight: 900, color: '#6366f1' }}>
                  {s.num}
                </div>
                <h4 style={{ margin: '0 0 6px', fontSize: 16, fontWeight: 800, color: '#0f172a' }}>{s.title}</h4>
                <p style={{ margin: 0, fontSize: 13, color: '#64748b', lineHeight: 1.6 }}>{s.desc}</p>
                {i < STEPS_INFO.length - 1 && (
                  <div className="step-connector" style={{ position: 'absolute', top: 28, left: -20, width: 40, height: 2, background: '#e2e8f0', display: 'none' }} />
                )}
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORM SECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <section id="ticket-form" style={{ background: '#f8fafc', padding: '60px 24px 80px', borderTop: '1px solid #f1f5f9' }}>
        <div style={{ maxWidth: 880, margin: '0 auto' }}>
          
          {/* Section Header */}
          <motion.div initial={{ opacity: 0, y: 15 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }}
            style={{ textAlign: 'center', marginBottom: 40 }}>
            <p style={{ color: '#6366f1', fontSize: 13, fontWeight: 700, letterSpacing: 2, marginBottom: 8 }}>â—  Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø·Ù„Ø¨</p>
            <h2 style={{ fontSize: 28, fontWeight: 900, color: '#0f172a', marginBottom: 8 }}>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¯Ø¹Ù… ÙÙ†ÙŠ</h2>
            <p style={{ color: '#64748b', fontSize: 15 }}>ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø¯Ù‚Ø© Ù„Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø®Ø¯Ù…ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„</p>
          </motion.div>

          {/* Form Card */}
          <motion.form onSubmit={submit} initial={{ opacity: 0, y: 20 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }}
            style={{ background: '#fff', borderRadius: 24, boxShadow: '0 20px 60px rgba(0,0,0,0.06)', border: '1px solid #e2e8f0', overflow: 'hidden' }}>
            
            {/* Gradient top */}
            <div style={{ height: 4, background: 'linear-gradient(90deg, #6366f1, #06b6d4, #8b5cf6)' }} />

            <div style={{ padding: '44px 48px' }}>
              {/* Error */}
              {error && (
                <motion.div initial={{ opacity: 0, y: -8 }} animate={{ opacity: 1, y: 0 }}
                  style={{ background: '#fef2f2', border: '1px solid #fecaca', borderRadius: 14, padding: '14px 18px', marginBottom: 28, display: 'flex', alignItems: 'center', gap: 10 }}>
                  <span style={{ fontSize: 18 }}>âš ï¸</span>
                  <span style={{ color: '#dc2626', fontWeight: 600, fontSize: 14 }}>{error}</span>
                </motion.div>
              )}

              {/* â”€â”€ Step 1: Contact Info â”€â”€ */}
              <SectionLabel number="01" title="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„" />
              <div style={grid2}>
                <Field label="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
                  <Input placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ" value={form.requester_name} onChange={e => set('requester_name', e.target.value)} required icon="ğŸ‘¤" />
                </Field>
                <Field label="Ø§Ù„Ù‚Ø³Ù… / Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©" required>
                  <Input placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©" value={form.requester_department} onChange={e => set('requester_department', e.target.value)} required icon="ğŸ¢" />
                </Field>
                <Field label="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
                  <Input type="email" placeholder="email@company.com" value={form.requester_email} onChange={e => set('requester_email', e.target.value)} required icon="âœ‰ï¸" />
                </Field>
                <Field label="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
                  <Input type="tel" placeholder="01xxxxxxxxx" value={form.requester_phone} onChange={e => set('requester_phone', e.target.value)} required icon="ğŸ“" />
                </Field>
              </div>

              <Divider />

              {/* â”€â”€ Step 2: Category â”€â”€ */}
              <SectionLabel number="02" title="ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©" />
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px, 1fr))', gap: 14, marginBottom: 32 }}>
                {CATEGORIES.map(cat => (
                  <button key={cat.value} type="button" onClick={() => { set('category', cat.value); setError(''); }}
                    className="category-btn"
                    style={{
                      border: form.category === cat.value ? `2px solid ${cat.color}` : '2px solid #f1f5f9',
                      borderRadius: 16, padding: '20px 18px', cursor: 'pointer', textAlign: 'right',
                      background: form.category === cat.value ? `${cat.color}08` : '#fafbfc',
                      display: 'flex', alignItems: 'flex-start', gap: 14,
                      boxShadow: form.category === cat.value ? `0 4px 20px ${cat.color}20` : 'none',
                      transition: 'all 0.25s ease', position: 'relative', overflow: 'hidden',
                    }}>
                    {/* Left accent line when selected */}
                    {form.category === cat.value && (
                      <div style={{ position: 'absolute', top: 0, right: 0, bottom: 0, width: 3, background: cat.color, borderRadius: '0 4px 4px 0' }} />
                    )}
                    <span style={{ fontSize: 28, lineHeight: 1, flexShrink: 0 }}>{cat.emoji}</span>
                    <div style={{ flex: 1 }}>
                      <p style={{ margin: 0, fontWeight: 700, fontSize: 14, color: form.category === cat.value ? cat.color : '#1e293b' }}>{cat.label}</p>
                      <p style={{ margin: '4px 0 0', fontSize: 12, color: '#94a3b8', lineHeight: 1.5 }}>{cat.desc}</p>
                    </div>
                    {form.category === cat.value && (
                      <span style={{ width: 22, height: 22, borderRadius: '50%', background: cat.color, display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>
                        <svg width="12" height="12" fill="none" stroke="#fff" strokeWidth="2.5" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"/></svg>
                      </span>
                    )}
                  </button>
                ))}
              </div>

              <Divider />

              {/* â”€â”€ Step 3: Description â”€â”€ */}
              <SectionLabel number="03" title="ÙˆØµÙ Ø§Ù„Ø·Ù„Ø¨" />
              <div style={{ display: 'flex', flexDirection: 'column', gap: 20 }}>
                <Field label="Ø¹Ù†ÙˆØ§Ù† Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ø´ÙƒÙ„Ø©" required>
                  <Input placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø·Ø§Ø¨Ø¹Ø© Ù„Ø§ ØªØ·Ø¨Ø¹ ÙÙŠ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«" value={form.title} onChange={e => set('title', e.target.value)} required />
                </Field>
                <Field label="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ">
                  <textarea value={form.description} onChange={e => set('description', e.target.value)}
                    placeholder="Ø§Ø´Ø±Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨ØªÙØ§ØµÙŠÙ„ Ø£ÙƒØ«Ø± Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙ†Ø§ ÙÙŠ Ø­Ù„Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø£Ø³Ø±Ø¹..."
                    rows={4}
                    className="form-input"
                    style={{ width: '100%', background: '#f8fafc', border: '1.5px solid #e2e8f0', borderRadius: 12, padding: '14px 16px', fontSize: 15, color: '#0f172a', outline: 'none', fontFamily: 'inherit', resize: 'vertical', minHeight: 120, lineHeight: 1.7, transition: 'border-color 0.2s, box-shadow 0.2s' }}
                  />
                </Field>
                <Field label="Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£Ù‡Ù…ÙŠØ©">
                  <div style={{ display: 'flex', gap: 10, flexWrap: 'wrap' }}>
                    {PRIORITIES.map(p => (
                      <button key={p.value} type="button" onClick={() => set('priority', p.value)}
                        style={{
                          flex: '1 1 100px', padding: '12px 18px', border: form.priority === p.value ? `2px solid ${p.color}` : '2px solid #e2e8f0',
                          borderRadius: 12, cursor: 'pointer', fontWeight: 700, fontSize: 14,
                          background: form.priority === p.value ? `${p.color}10` : '#fafbfc',
                          color: form.priority === p.value ? p.color : '#64748b',
                          boxShadow: form.priority === p.value ? `0 4px 16px ${p.color}20` : 'none',
                          transition: 'all 0.2s ease',
                          display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8,
                        }}>
                        <span style={{ fontSize: 12 }}>{p.icon}</span>
                        {p.label}
                      </button>
                    ))}
                  </div>
                </Field>
              </div>
            </div>

            {/* â”€â”€ Submit Footer â”€â”€ */}
            <div style={{ background: '#f8fafc', borderTop: '1px solid #e2e8f0', padding: '24px 48px', display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: 16 }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>
                <span style={{ width: 8, height: 8, borderRadius: '50%', background: '#22c55e', boxShadow: '0 0 0 3px rgba(34,197,94,0.15)' }} />
                <span style={{ color: '#64748b', fontSize: 13, fontWeight: 600 }}>Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­ Â· Ù…ØªØ§Ø­ Ù¢Ù¤/Ù§</span>
              </div>
              <motion.button type="submit" disabled={loading} whileHover={{ scale: loading ? 1 : 1.02 }} whileTap={{ scale: loading ? 1 : 0.97 }}
                style={{
                  background: loading ? '#94a3b8' : 'linear-gradient(135deg, #6366f1, #4f46e5)',
                  color: '#fff', border: 'none', borderRadius: 14, padding: '15px 40px',
                  fontWeight: 800, fontSize: 16, cursor: loading ? 'not-allowed' : 'pointer',
                  boxShadow: loading ? 'none' : '0 8px 32px rgba(99,102,241,0.30)',
                  display: 'flex', alignItems: 'center', gap: 10, transition: 'all 0.2s',
                }}>
                {loading ? (
                  <><span className="submit-spinner" />Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...</>
                ) : (
                  <><svg width="18" height="18" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" viewBox="0 0 24 24" style={{ transform: 'scaleX(-1)' }}><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</>
                )}
              </motion.button>
            </div>
          </motion.form>
        </div>
      </section>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <footer style={{ background: '#0f172a', padding: '40px 24px', textAlign: 'center', borderTop: '1px solid #1e293b' }}>
        <div style={{ maxWidth: 600, margin: '0 auto' }}>
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 10, marginBottom: 16 }}>
            <div style={{ width: 32, height: 32, borderRadius: 8, background: 'linear-gradient(135deg, #6366f1, #8b5cf6)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
              <svg width="16" height="16" fill="none" stroke="#fff" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>
            </div>
            <span style={{ fontSize: 16, fontWeight: 800, color: '#fff' }}>{COMPANY.name}</span>
          </div>
          <p style={{ color: '#475569', fontSize: 13, lineHeight: 1.7, marginBottom: 16 }}>
            Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Â· ÙØ±ÙŠÙ‚Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ø®Ø¯Ù…ØªÙƒ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©
          </p>
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 20, flexWrap: 'wrap' }}>
            <span style={{ color: '#64748b', fontSize: 12 }}>ğŸ“§ support@company.com</span>
            <span style={{ color: '#334155' }}>Â·</span>
            <span style={{ color: '#64748b', fontSize: 12 }}>ğŸ“ Ø¯Ø§Ø®Ù„ÙŠ: 100</span>
            <span style={{ color: '#334155' }}>Â·</span>
            <span style={{ color: '#64748b', fontSize: 12 }}>ğŸ¢ Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</span>
          </div>
          <div style={{ height: 1, background: '#1e293b', margin: '24px 0' }} />
          <p style={{ color: '#475569', fontSize: 12 }}>Â© {new Date().getFullYear()} {COMPANY.name} Â· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â· Ù†Ø¸Ø§Ù… IT System Management</p>
        </div>
      </footer>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRACK MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <AnimatePresence>
        {showTracker && (
          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}
            style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', backdropFilter: 'blur(4px)', zIndex: 100, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: 20 }}
            onClick={() => setShowTracker(false)}>
            <motion.div initial={{ scale: 0.9, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0.9, opacity: 0 }}
              onClick={e => e.stopPropagation()}
              style={{ background: '#fff', borderRadius: 24, width: '100%', maxWidth: 480, boxShadow: '0 25px 60px rgba(0,0,0,0.15)', overflow: 'hidden' }}>
              <div style={{ height: 4, background: 'linear-gradient(90deg, #6366f1, #06b6d4)' }} />
              <div style={{ padding: '32px 36px' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 24 }}>
                  <h3 style={{ margin: 0, fontSize: 20, fontWeight: 800, color: '#0f172a' }}>ğŸ” ØªØªØ¨Ø¹ Ø·Ù„Ø¨Ùƒ</h3>
                  <button onClick={() => setShowTracker(false)} style={{ background: '#f1f5f9', border: 'none', borderRadius: 10, width: 36, height: 36, display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', color: '#64748b' }}>âœ•</button>
                </div>
                <p style={{ color: '#64748b', fontSize: 14, marginBottom: 20, lineHeight: 1.6 }}>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ØªØ°ÙƒØ±Ø© Ù„Ù…Ø¹Ø±ÙØ© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</p>
                <div style={{ display: 'flex', gap: 10, marginBottom: 16 }}>
                  <input value={trackInput} onChange={e => setTrackInput(e.target.value)} placeholder="Ù…Ø«Ø§Ù„: TKT-20261201-001"
                    onKeyDown={e => e.key === 'Enter' && handleTrack()}
                    style={{ flex: 1, background: '#f8fafc', border: '1.5px solid #e2e8f0', borderRadius: 12, padding: '13px 16px', color: '#0f172a', fontSize: 15, fontFamily: 'monospace', outline: 'none' }}
                    onFocus={e => e.target.style.borderColor = '#6366f1'} onBlur={e => e.target.style.borderColor = '#e2e8f0'} />
                  <button onClick={handleTrack} disabled={trackLoading}
                    style={{ background: 'linear-gradient(135deg, #6366f1, #4f46e5)', color: '#fff', border: 'none', borderRadius: 12, padding: '13px 24px', fontWeight: 700, fontSize: 15, cursor: 'pointer', boxShadow: '0 4px 16px rgba(99,102,241,0.25)' }}>
                    {trackLoading ? '...' : 'ØªØªØ¨Ø¹'}
                  </button>
                </div>
                {trackError && <div style={{ background: '#fef2f2', border: '1px solid #fecaca', borderRadius: 12, padding: '12px 16px', color: '#dc2626', fontSize: 13, fontWeight: 600, marginBottom: 12 }}>âš ï¸ {trackError}</div>}
                {trackResult && <TrackResultCard result={trackResult} />}
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      <PortalStyles />
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function Navbar({ scrolled, onTrack }) {
  return (
    <nav style={{
      position: 'fixed', top: 0, left: 0, right: 0, zIndex: 50,
      background: scrolled ? 'rgba(255,255,255,0.92)' : 'transparent',
      backdropFilter: scrolled ? 'blur(12px)' : 'none',
      borderBottom: scrolled ? '1px solid rgba(226,232,240,0.6)' : '1px solid transparent',
      transition: 'all 0.35s ease',
      padding: '0 24px',
    }}>
      <div style={{ maxWidth: 1200, margin: '0 auto', display: 'flex', alignItems: 'center', justifyContent: 'space-between', height: 64 }} dir="rtl">
        {/* Logo */}
        <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>
          <div style={{ width: 34, height: 34, borderRadius: 10, background: 'linear-gradient(135deg, #6366f1, #8b5cf6)', display: 'flex', alignItems: 'center', justifyContent: 'center', boxShadow: '0 4px 12px rgba(99,102,241,0.25)' }}>
            <svg width="18" height="18" fill="none" stroke="#fff" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" /></svg>
          </div>
          <span style={{ fontSize: 16, fontWeight: 800, color: scrolled ? '#0f172a' : '#fff', transition: 'color 0.3s' }}>{COMPANY.name}</span>
        </div>

        {/* Actions */}
        <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>
          <button onClick={onTrack}
            style={{ background: scrolled ? '#f1f5f9' : 'rgba(255,255,255,0.1)', border: scrolled ? '1px solid #e2e8f0' : '1px solid rgba(255,255,255,0.15)', color: scrolled ? '#475569' : '#e2e8f0', borderRadius: 10, padding: '8px 18px', fontWeight: 600, fontSize: 13, cursor: 'pointer', display: 'flex', alignItems: 'center', gap: 6, transition: 'all 0.3s' }}>
            ğŸ” ØªØªØ¨Ø¹ Ø·Ù„Ø¨
          </button>
          <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>
            <span style={{ width: 7, height: 7, borderRadius: '50%', background: '#22c55e', boxShadow: '0 0 0 2px rgba(34,197,94,0.2)' }} />
            <span style={{ fontSize: 12, fontWeight: 600, color: scrolled ? '#64748b' : 'rgba(255,255,255,0.7)', transition: 'color 0.3s' }}>Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù†</span>
          </div>
        </div>
      </div>
    </nav>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRACK RESULT CARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function TrackResultCard({ result }) {
  const statusMap = {
    open:        { label: 'Ù…ÙØªÙˆØ­', color: '#3b82f6', bg: '#eff6ff' },
    in_progress: { label: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', color: '#f97316', bg: '#fff7ed' },
    resolved:    { label: 'ØªÙ… Ø§Ù„Ø­Ù„', color: '#22c55e', bg: '#f0fdf4' },
    closed:      { label: 'Ù…ØºÙ„Ù‚', color: '#64748b', bg: '#f8fafc' },
  };
  const s = statusMap[result.status] || { label: result.status, color: '#94a3b8', bg: '#f8fafc' };
  return (
    <motion.div initial={{ opacity: 0, y: 8 }} animate={{ opacity: 1, y: 0 }}
      style={{ background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: 16, padding: '18px 20px', marginTop: 12 }}>
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12, flexWrap: 'wrap', gap: 8 }}>
        <span style={{ fontFamily: 'monospace', color: '#6366f1', fontWeight: 800, fontSize: 15 }}>{result.ticket_number}</span>
        <span style={{ background: s.bg, color: s.color, border: `1px solid ${s.color}30`, borderRadius: 20, padding: '4px 14px', fontWeight: 700, fontSize: 12 }}>{s.label}</span>
      </div>
      <p style={{ margin: '0 0 8px', color: '#0f172a', fontWeight: 700, fontSize: 14 }}>{result.title}</p>
      {result.assigned_to_name && (
        <p style={{ margin: '0 0 4px', color: '#64748b', fontSize: 12 }}>ğŸ‘¤ Ù…Ø®ØµØµ Ø¥Ù„Ù‰: <span style={{ color: '#334155', fontWeight: 600 }}>{result.assigned_to_name}</span></p>
      )}
      <p style={{ margin: 0, color: '#94a3b8', fontSize: 11 }}>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: {new Date(result.updated_at).toLocaleString('ar-EG')}</p>
    </motion.div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORM SUB-COMPONENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function Input({ icon, ...props }) {
  return (
    <div style={{ position: 'relative' }}>
      {icon && <span style={{ position: 'absolute', right: 14, top: '50%', transform: 'translateY(-50%)', fontSize: 16, pointerEvents: 'none' }}>{icon}</span>}
      <input {...props} className="form-input"
        style={{ width: '100%', background: '#f8fafc', border: '1.5px solid #e2e8f0', borderRadius: 12, padding: `13px ${icon ? '44px' : '16px'} 13px 16px`, fontSize: 15, color: '#0f172a', outline: 'none', fontFamily: 'inherit', transition: 'border-color 0.2s, box-shadow 0.2s' }}
      />
    </div>
  );
}

function Field({ label, children, required }) {
  return (
    <div>
      <label style={{ display: 'block', fontSize: 13, fontWeight: 700, color: '#374151', marginBottom: 8 }}>
        {label} {required && <span style={{ color: '#f43f5e' }}>*</span>}
      </label>
      {children}
    </div>
  );
}

function SectionLabel({ number, title }) {
  return (
    <div style={{ display: 'flex', alignItems: 'center', gap: 12, marginBottom: 24 }}>
      <span style={{ width: 36, height: 36, borderRadius: 12, background: 'linear-gradient(135deg, #eef2ff, #e0e7ff)', color: '#6366f1', fontSize: 13, fontWeight: 800, display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>{number}</span>
      <h3 style={{ margin: 0, fontSize: 18, fontWeight: 800, color: '#0f172a' }}>{title}</h3>
    </div>
  );
}

function Divider() {
  return <div style={{ height: 1, background: 'linear-gradient(90deg, transparent, #e2e8f0 20%, #e2e8f0 80%, transparent)', margin: '32px 0' }} />;
}

const grid2 = { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(260px, 1fr))', gap: '20px 28px' };

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STYLES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function PortalStyles() {
  return (
    <style>{`
      .ticket-portal * { box-sizing: border-box; margin: 0; }
      .ticket-portal { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; color: #0f172a; }

      .form-input:focus {
        border-color: #6366f1 !important;
        box-shadow: 0 0 0 4px rgba(99,102,241,0.1) !important;
      }

      .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0,0,0,0.08) !important;
        border-color: #e2e8f0 !important;
      }

      .category-btn:hover {
        border-color: #c7d2fe !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 20px rgba(99,102,241,0.08) !important;
      }

      .submit-spinner {
        width: 18px;
        height: 18px;
        border: 2.5px solid rgba(255,255,255,0.3);
        border-top-color: #fff;
        border-radius: 50%;
        display: inline-block;
        animation: spin 0.7s linear infinite;
      }

      @keyframes spin { to { transform: rotate(360deg); } }

      @keyframes float {
        0% { transform: translateY(0px) scale(1); opacity: 0.3; }
        100% { transform: translateY(-30px) scale(1.3); opacity: 0.6; }
      }

      @media (max-width: 640px) {
        .ticket-portal form > div:last-child { padding: 20px 24px !important; }
        .ticket-portal form > div:nth-child(2) { padding: 32px 24px !important; }
      }

      /* Smooth scrollbar */
      .ticket-portal::-webkit-scrollbar { width: 6px; }
      .ticket-portal::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    `}</style>
  );
}
